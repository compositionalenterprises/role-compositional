---
# defaults file for role-compositional

#
# General Vars (o7)
#
compositional_frontend_service: 'nginx'
compositional_backend_service: 'mariadb'
compositional_database_root_password: 'testpassword'
compositional_services:
  - 'bitwarden'
  - 'bookstack'
  - 'firefly'
  - 'kanboard'
  - 'manager'
  - 'nextcloud'
  - 'rundeck'
  - 'wordpress'
# Here we want to default to portal if it's being deployed.
# Otherwise, just default to nill and have it redirect to the
# default html welcome page
compositional_webroot_redirect: {% if 'portal' in compositional_services %}portal{% endif %}

#
# Environment Vars
#
environment_domain: 'example.com'
environment_admin: 'admin'

#
# Nginx Frontend
#
compositional_nginx_build: 'yes'
compositional_nginx_state: 'present'
compositional_nginx_restarted: no
compositional_nginx_version: '1.17'
compositional_nginx_storage: 'local'

#
# MariaDB Backend
#
compositional_mariadb_build: 'yes'
compositional_mariadb_state: 'present'
compositional_mariadb_restarted: yes
compositional_mariadb_version: '10.4'
compositional_mariadb_storage: 'local'

#
# Kanboard
#
compositional_kanboard_build: yes
compositional_kanboard_state: present
compositional_kanboard_restarted: yes
compositional_kanboard_version: 'v1.2.8'
compositional_kanboard_storage: 'local'
compositional_kanboard_backend_password: 'testpassword'
compositional_kanboard_mysql_script: |
  CREATE USER IF NOT EXISTS 'kanboard'@'%' IDENTIFIED BY '{{ compositional_kanboard_backend_password }}';
  CREATE DATABASE IF NOT EXISTS kanboard CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
  GRANT ALTER, CREATE, DELETE, DROP, INDEX, INSERT, REFERENCES, SELECT, UPDATE ON kanboard.* TO 'kanboard'@'%';

#
# Nextcloud
#
compositional_nextcloud_build: yes
compositional_nextcloud_state: present
compositional_nextcloud_restarted: yes
compositional_nextcloud_version: '18'
compositional_nextcloud_storage: 'local'
compositional_nextcloud_backend_password: 'testpassword'
compositional_nextcloud_mysql_script: |
  CREATE USER IF NOT EXISTS 'nextcloud'@'%' IDENTIFIED BY '{{ compositional_nextcloud_backend_password }}';
  CREATE DATABASE IF NOT EXISTS nextcloud;
  GRANT ALL PRIVILEGES ON nextcloud.* TO 'nextcloud'@'%' IDENTIFIED BY '{{ compositional_nextcloud_backend_password }}';
  FLUSH privileges;
compositional_nextcloud_admin_user: 'admin'
compositional_nextcloud_admin_password: 'admin'
compositional_nextcloud_legacy_dbtableprefix: False

#
# Wordpress
#
compositional_wordpress_build: yes
compositional_wordpress_state: present
compositional_wordpress_restarted: yes
compositional_wordpress_version: '5.2.2'
compositional_wordpress_storage: 'local'
compositional_wordpress_backend_password: 'testpassword'
compositional_wordpress_mysql_script: |
  CREATE USER IF NOT EXISTS 'wordpress'@'%' IDENTIFIED BY '{{ compositional_wordpress_backend_password }}';
  CREATE DATABASE IF NOT EXISTS wordpress;
  GRANT ALL PRIVILEGES ON wordpress.* TO 'wordpress'@'%';

#
# Bitwarden
#
compositional_bitwarden_build: yes
compositional_bitwarden_state: present
compositional_bitwarden_restarted: yes
compositional_bitwarden_version: '1.14.1-alpine'
compositional_bitwarden_storage: 'local'

#
# Firefly
#
# This value has to be exactly 32 characters, it is the encryption key for your database and sessions
compositional_firefly_build: yes
compositional_firefly_state: present
compositional_firefly_restarted: yes
compositional_firefly_version: 'release-4.8.0.3'
compositional_firefly_storage: 'local'
compositional_firefly_app_key: 'testtesttesttesttesttesttesttest'
compositional_firefly_backend_password: 'testpassword'
compositional_firefly_mysql_script: |
  CREATE USER IF NOT EXISTS 'firefly'@'%' IDENTIFIED BY '{{ compositional_firefly_backend_password }}';
  CREATE DATABASE IF NOT EXISTS firefly;
  GRANT ALL PRIVILEGES ON firefly.* TO 'firefly'@'%';

#
# Manager
#
# This value has to be exactly 32 characters, it is the encryption key for your database and sessions
compositional_manager_build: yes
compositional_manager_state: present
compositional_manager_restarted: no
compositional_manager_version: '19.7.71'
compositional_manager_storage: 'local'
compositional_manager_port: '8080'
compositional_manager_data_path: '/data'

#
# Jekyll
#
# This value has to be exactly 32 characters, it is the encryption key for your database and sessions
compositional_jekyll_build: yes
compositional_jekyll_state: present
compositional_jekyll_restarted: yes
compositional_jekyll_version: '3.8'
compositional_jekyll_storage: 'local'
compositional_jekyll_port: '8080'
compositional_jekyll_git_url: 'https://github.com/volny/creative-theme-jekyll.git'
compositional_jekyll_extra_commands: |
  echo "Hello, World!"
  echo "Command number 2"

#
# Rundeck
#
compositional_rundeck_build: yes
compositional_rundeck_state: present
compositional_rundeck_restarted: yes
compositional_rundeck_version: '3.2.5'
compositional_rundeck_storage: 'local'
compositional_rundeck_backend_password: 'testpassword'
compositional_rundeck_mysql_script: |
  CREATE USER IF NOT EXISTS 'rundeck'@'%' IDENTIFIED BY '{{ compositional_rundeck_backend_password }}';
  CREATE DATABASE IF NOT EXISTS rundeck;
  GRANT ALL PRIVILEGES ON rundeck.* TO 'rundeck'@'%';
compositional_rundeck_additional_setup: |
  echo "Hello, World!"
  echo "Command number 2"

#
# BookStack
#
compositional_bookstack_build: yes
compositional_bookstack_state: present
compositional_bookstack_restarted: yes
compositional_bookstack_version: '0.27.5'
compositional_bookstack_storage: 'local'
compositional_bookstack_backend_password: 'testpassword'
compositional_bookstack_mysql_script: |
  CREATE USER IF NOT EXISTS 'bookstack'@'%' IDENTIFIED BY '{{ compositional_bookstack_backend_password }}';
  CREATE DATABASE IF NOT EXISTS bookstack;
  GRANT ALL PRIVILEGES ON bookstack.* TO 'bookstack'@'%';

#
# Portal
#
compositional_portal_build: yes
compositional_portal_state: present
compositional_portal_restarted: yes
compositional_portal_version: '1.1.0'
compositional_portal_storage: 'local'
compositional_portal_backend_password: 'testpassword'
compositional_portal_production_key: 'cb569b8ea39a7dada216dffaee8f7ec3'
compositional_portal_production_yml_enc: 'mMb7knWzem8t5jXbs66LiTh+MuR4VhwttCJcshES87zG37kDxQ6tqKE5FiW3BW70orag1vVTxfL6kxnd665c/P0L9/ImWFKtbPNBbomsy/CVyFbQo4VkWC0SOi1FzKNFKkmLPdjcqFt0A37BYQjXdTNk+7x9IGyTI2tZg4h2p6qqGXB5NBJYIWoXEmCTnO9H05HxMoCqhTQCoCZeKeXKVIppweTsT80LIIVM6VJIomaSItp/XzMrmvaKek466hw9koR5z7dinzAtJnnsrBzbfF2+yAtryp8jpi+gvpll--qAM4pQghNMegIdn5--uKGo/l6lbwxIORk+raRVOw=='
compositional_portal_admin_password: 'testpassword'
compositional_portal_org_name: "{{ environment_domain.split('.')[0].upper() }}"
compositional_portal_admin_email: "{{ environment_admin }}@{{ environment_domain }}"
compositional_portal_mysql_script: |
  CREATE USER IF NOT EXISTS 'portal'@'%' IDENTIFIED BY '{{ compositional_portal_backend_password }}';
  CREATE DATABASE IF NOT EXISTS portal;
  GRANT ALL PRIVILEGES ON portal.* TO 'portal'@'%';
